<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Поиск туров - SinkTravel</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <nav>
    <p><a href="/"><img id="icon" src="/images/icon.svg"></a>
    <a href="/take-tour"><button id="takeTour">Подобрать тур</button></a></p>
    <% if (user) { %>
      <p><a href="/search"><img id="active" src="/images/search.svg"></a>
      <img id="active" src="/images/profile.svg" onclick="window.location.href='/profile'">
      <button onclick="window.location.href='/logout'">Выйти</button></p>
    <% } else { %>
      <p>
        <a href="/search"><img id="active" src="/images/search.svg"></a>
        <button onclick="window.location.href='/login'">Войти</button>
      </p>
    <% } %>
  </nav>

  <main class="search-page">

    <h1 id="name">Поиск туров</h1>

    <div class="search-wrapper">
      <form action="/search" method="POST" class="search-filter-panel">
        <p><label>
          Пункт назначения
          <select name="cityId">
            <option value="">Любой</option>
            <% cities.forEach(city => { %>
              <option value="<%= city.id %>"><%= city.name %></option>
            <% }) %>
          </select>
        </label></p>

        <p><label>
          Длительность (дней)
          <input type="number" name="duration" placeholder="Любая" min="1">
        </label></p>

        <p><label>
          Отель
          <select name="hotelId">
            <option value="">Любой</option>
            <% hotels.forEach(hotel => { %>
              <option value="<%= hotel.id %>"><%= hotel.name %> (<%= hotel.stars %>★)</option>
            <% }) %>
          </select>
        </label></p>

        <p><label>
          Звёздность отеля
          <select name="hotelStars">
            <option value="">Любая</option>
            <option value="1">1★</option>
            <option value="2">2★</option>
            <option value="3">3★</option>
            <option value="4">4★</option>
            <option value="5">5★</option>
          </select>
        </label></p>

        <p><label>
          Цена от
          <input type="number" name="minPrice" placeholder="0">
        </label></p>

        <p><label>
          Цена до
          <input type="number" name="maxPrice" placeholder="100000">
        </label></p>

        <button type="submit" class="btn-primary">Найти</button>
      </form>

      <div class="tours-container" style="margin-left: 300px;">
        <% if (tours && tours.length > 0) { %>
          <% tours.forEach(tour => { %>
            <a href="/tour/<%= tour.id %>" class="tour-link">
              <div class="tour-card">
                <div class="tour-content" style="width: 700px;">
                  <img src="<%= tour.image || '/images/zaglushka.png' %>" class="tour-image">
                  <div class="tour-info">
                    <h2><%= tour.name %></h2>
                    <p class="tour-description"><%= tour.description || 'Нет описания' %></p>
                    <div class="bottom-panel">
                      <div class="tour-price"><%= tour.price.toFixed(2) %>₽</div>
                      <div><button>Купить</button></div>
                    </div>
                  </div>
                </div>
              </div>
            </a>
          <% }); %>
        <% } else { %>
          <div class="no-tours">
            <p>Туров не найдено</p>
          </div>
        <% } %>
      </div>
    </div>

  </main>

  <footer>
    <p>©SinkTravel
    <a href="/catalog">Каталог</a>
    <a href="/take-tour">Подобрать тур</a>
    <a href="/search">Поиск</a>
    <a href="/profile">Профиль</a></p>
  </footer>
</body>
</html>
