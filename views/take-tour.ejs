<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Подобрать тур</title>
  <link rel="stylesheet" href="/styles.css">
</head>

<body>
  <nav>
    <p><a href="/"><img id="icon" src="/images/icon.svg"></a>
    <a href="/take-tour"><button id="takeTour">Подобрать тур</button></a></p>
    <% if (user) { %>
      <p><a href="/search"><img id="active" src="/images/search.svg"></a>
      <img id="active" src="/images/profile.svg" onclick="window.location.href='/profile'">
      <button onclick="window.location.href='/logout'">Выйти</button></p>
    <% } else { %>
      <p>
        <a href="/search"><img id="active" src="/images/search.svg"></a>
        <button onclick="window.location.href='/login'">Войти</button>
      </p>
    <% } %>
  </nav>

  <main class="take-tour-page">

    <h1 id="name">Подбор тура</h1>

    <div class="take-tour-wrapper">

      <form action="/take-tour" method="POST" class="filter-panel">

        <section>
          <p><label>
            Пункт назначения
            <select name="cityId">
              <option value="">Любой</option>
              <% cities.forEach(city => { %>
                <option value="<%= city.id %>"><%= city.name %></option>
              <% }) %>
            </select>
          </label></p>

          <p><label>
            Длительность (дней)
            <input type="number" name="duration" placeholder="Любая" min="1">
          </label></p>

          <p><label>
            Отель
            <select name="hotelId">
              <option value="">Любой</option>
              <% hotels.forEach(hotel => { %>
                <option value="<%= hotel.id %>"><%= hotel.name %> (<%= hotel.stars %>★)</option>
              <% }) %>
            </select>
          </label></p>

          <p><label>
            Звёздность отеля
            <select name="hotelStars">
              <option value="">Любая</option>
              <option value="1">1★</option>
              <option value="2">2★</option>
              <option value="3">3★</option>
              <option value="4">4★</option>
              <option value="5">5★</option>
            </select>
          </label></p>

          <p><label>
            Цена от
            <input type="number" name="minPrice" placeholder="0">
          </label></p>
          <p><label>
            Цена до
            <input type="number" name="maxPrice" placeholder="100000">
          </label></p>
        </section>

        <button type="submit" class="btn-primary">Подобрать</button>
      </form>

      <div class="tours-container">
        <% if (tours && tours.length > 0) { %>
          <% tours.forEach(tour => { %>
          <a href="/tour/<%= tour.id %>" class="tour-link">
            <div class="tour-card">
              <div class="tour-content">
                <img src="/images/abkhazia.png" class="tour-image">
                <div class="tour-info">
                  <h2><%= tour.name %></h2>
                  <p class="tour-description"><%= tour.description || 'Нет описания' %></p>
                  <div class="bottom-panel">
                    <div class="tour-price"><%= tour.price.toFixed(2) %>₽</div>
                    <div><button>Купить</button></div>
                  </div>
                </div>
              </div>
            </div>
          </a>
          <% }); %>
        <% } else { %>
          <div class="no-tours">
            <p>Пока нет доступных туров</p>
          </div>
        <% } %>
      </div>

    </div>

  </main>

  <footer>
    <p>©SinkTravel
      <a href="/catalog">Каталог</a>
      <a href="/take-tour">Подобрать тур</a>
      <a href="/cart">Корзина</a>
      <a href="/search">Поиск</a>
      <a href="/profile">Профиль</a>
    </p>
  </footer>

</body>
</html>
